<!DOCTYPE html>
<html><head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Psychedelic</title>
  <script src="http://twgljs.org/dist/4.x/twgl-full.min.js"></script>
  <style>
    canvas {
        display: block;
        width: min(100vw, 100vh);
        height: min(100vw, 100vh);
        margin:0em; padding:0em;
    }
    body { margin:0em; padding:0em; }
  </style>
</head>
  <body>
    <canvas width="100" height="20" id="c"></canvas>
  <script id="vs" type="x-shader/x-vertex">      

attribute vec4 a_position;

void main() {
    gl_Position = a_position;
}

  </script>
  <script id="fs" type="x-shader/x-fragment">  

precision mediump float;

uniform float u_time;
uniform float u_resolution;

// via https://gist.github.com/983/e170a24ae8eba2cd174f
vec3 rgb2hsv(vec3 c) {
  vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
  vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
  vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

  float d = q.x - min(q.w, q.y);
  float e = 1.0e-10;
  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
}

// inspiration via experimenting with https://www.shaderific.com/glsl-functions
void main(){
  vec2 uv = gl_FragCoord.xy * 0.05;
  float h = mix(0.5*sin(uv.x)+0.5, 0.5*sin(uv.y + u_time * 0.1)+0.5, 0.5*cos(u_time)+0.5);
  float s = 0.5 * sin(cos(uv.x + u_time * 0.3) * cos(uv.y) + u_time) + 0.5;
  float v = 0.5 * cos(u_time * 0.2) + 0.5;
	vec3 hsv = fract(vec3(h, s, v));
	gl_FragColor = vec4(rgb2hsv(hsv), 1.0);
}

  </script>
  <script type="text/javascript">//<!--
"use strict";
twgl.setDefaults({attribPrefix: "a_"})
var gl = twgl.getWebGLContext(document.getElementById("c"));
var programInfo = twgl.createProgramInfo(gl, ["vs", "fs"]);

var arrays = {
    position: [-1, -1, 0, 1, -1, 0, -1, 1, 0, -1, 1, 0, 1, -1, 0, 1, 1, 0],
};

var bufferInfo = twgl.createBufferInfoFromArrays(gl, arrays);

function render(time) {
    twgl.resizeCanvasToDisplaySize(gl.canvas);
    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);

    const uniforms = {
      u_time: time * 0.001,
      u_resolution: [gl.canvas.width, gl.canvas.height]
    };

    gl.useProgram(programInfo.program);
    twgl.setBuffersAndAttributes(gl, programInfo, bufferInfo);
    twgl.setUniforms(programInfo, uniforms);
    twgl.drawBufferInfo(gl, bufferInfo);

    requestAnimationFrame(render);
}
requestAnimationFrame(render);

  

//--></script>
</body></html>
